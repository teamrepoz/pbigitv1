{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Name",
      "dax_expression": "'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME]",
      "solution_explanation": "Direct column mapping from MARKET_NAME; row-level transformation so created as a calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Minor Curve Mapping",
      "dax_expression": "VAR mt = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Title]\nRETURN\nSWITCH(\n    TRUE(),\n    mt = \"1m AUD Basis\", \"1m\",\n    mt = \"1m CAD Basis\", \"1m\",\n    mt = \"1m EUR Basis\", \"1m\",\n    mt = \"1m GBP Basis\", \"1m\",\n    mt = \"1m HKD Basis\", \"1m\",\n    mt = \"1m NZD Basis\", \"1m\",\n    mt = \"1m USD Basis\", \"1m\",\n    mt = \"3m JPY Basis\", \"3m\",\n    mt = \"6m AUD Basis\", \"6m\",\n    mt = \"6m CAD Basis\", \"6m\",\n    mt = \"6m CHF Basis\", \"6m\",\n    mt = \"6m EUR Basis\", \"6m\",\n    mt = \"6m EUR Libor Basis\", \"6m\",\n    mt = \"6m GBP Basis\", \"6m\",\n    mt = \"6m USD Basis\", \"6m\",\n    mt = \"12m USD Basis\", \"12m\",\n    mt = \"CCIRS AUD Basis\", \"CCIRS\",\n    mt = \"CCIRS CAD Basis\", \"CCIRS\",\n    mt = \"CCIRS CHF Basis\", \"CCIRS\",\n    mt = \"CCIRS CNH Basis\", \"CCIRS\",\n    mt = \"CCIRS EUR Basis\", \"CCIRS\",\n    mt = \"CCIRS GBP Basis\", \"CCIRS\",\n    mt = \"CCIRS HKD Basis\", \"CCIRS\",\n    mt = \"CCIRS INR Basis\", \"CCIRS\",\n    mt = \"CCIRS JPY Basis\", \"CCIRS\",\n    mt = \"CCIRS MYR Basis\", \"CCIRS\",\n    mt = \"CCIRS NZD Basis\", \"CCIRS\",\n    mt = \"CCIRS SEK Basis\", \"CCIRS\",\n    mt = \"OIS AUD Basis\", \"OIS\",\n    mt = \"OIS CAD Basis\", \"OIS\",\n    mt = \"OIS CHF Basis\", \"OIS\",\n    mt = \"OIS EUR Basis\", \"OIS\",\n    mt = \"OIS GBP Basis\", \"OIS\",\n    mt = \"OIS JPY Basis\", \"OIS\",\n    mt = \"OIS USD Basis\", \"OIS\",\n    mt = \"USD CAP Vol\", \"CAP Vol\",\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Name]\n)",
      "solution_explanation": "Translated Tableau CASE to DAX SWITCH(TRUE()) comparing 'Market Title' values; fallback returns the previously defined 'Market Name' calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Deal Partial Exclusion",
      "dax_expression": "IF(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TRADE_ID] = \"N/A\",\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[SECURITY_ID],\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TRADE_ID]\n)",
      "solution_explanation": "Row-level IF logic mapping directly to DAX IF; no aggregation or parameters."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "End of Month Date",
      "dax_expression": "VAR firstOfNextMonth = EOMONTH('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[EFFECTIVE_DATE], 0) + 1\nVAR lastDayOfMonth = EOMONTH('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[EFFECTIVE_DATE], 0)\nVAR w = WEEKDAY(lastDayOfMonth, 1)\nRETURN\nSWITCH(\n    TRUE(),\n    w = 7, WORKDAY(firstOfNextMonth, -2),\n    w = 1, WORKDAY(firstOfNextMonth, -3),\n    WORKDAY(firstOfNextMonth, -1)\n)",
      "solution_explanation": "Replicated DATEPART/DATEADD/DATETRUNC logic using EOMONTH, WEEKDAY, and WORKDAY to derive the last business day of the month for EFFECTIVE_DATE."
    },
    {
      "type": "measure",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Book Level 1",
      "dax_expression": "VAR param = SELECTEDVALUE('Book Level 1 Mapping'[Display As])\nRETURN\nSWITCH(\n    param,\n    \"Default\", 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[BOOK_LEVEL1],\n    \"IRD\", 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Book Level 1 NA IRD],\n    \"CAD Cash Rates\", 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Book Level 1 SCI],\n    \"CMF\", 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Book Level 1 CMF],\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[BOOK_LEVEL1]\n)",
      "solution_explanation": "Converted CASE with parameter to DAX using SELECTEDVALUE for the parameter and SWITCH for mapping; parameters necessitate a measure."
    },
    {
      "type": "measure",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Max Date Exclude",
      "dax_expression": "VAR wd = WEEKDAY(TODAY(), 1)\nRETURN\nSWITCH(\n    TRUE(),\n    wd = 1, TODAY() - 2,\n    wd = 2, TODAY() - 3,\n    TODAY() - 1\n)",
      "solution_explanation": "Translated CASE over DATEPART('weekday', TODAY()) into WEEKDAY and SWITCH; created as a measure to keep TODAY() dynamic at query time."
    }
  ]
}