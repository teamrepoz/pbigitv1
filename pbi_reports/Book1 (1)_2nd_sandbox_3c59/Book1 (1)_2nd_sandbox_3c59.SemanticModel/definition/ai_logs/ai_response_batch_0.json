{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T CAD 2Y",
      "dax_expression": "VAR baseCAD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T CAD] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR expr_sCADMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\",\n        baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\",\n        2/3 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\",\n        1/3 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month Swap\",\n        1/4 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month Swap\",\n        2/4 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month Swap\",\n        3/4 * baseCAD,\n        0\n    )\nVAR expr_CADsCAD1mMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\",\n        baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\",\n        2/3 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\",\n        1/3 * baseCAD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\", 1/4 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\", 2/4 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month\", 3/4 * baseCAD, 0)\nVAR expr_CADsCAD6mMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\",\n        baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\",\n        2/3 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\",\n        1/3 * baseCAD,\n        0\n    )\nVAR expr_CADsCAD1dMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\" || (\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Subtype] = \"Major Curve\" &&\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] > 365 &&\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] <= 731\n        ),\n        baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\",\n        2/3 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\",\n        1/3 * baseCAD,\n        0\n    )\nVAR expr_USDsCADUSDMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\",\n        baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\",\n        2/3 * baseCAD,\n        0\n    )\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\",\n        1/3 * baseCAD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\", 1/4 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\", 2/4 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month\", 3/4 * baseCAD, 0)\nRETURN\nSWITCH(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME],\n    \"sCADMid\", expr_sCADMid,\n    \"CADsCAD1mMid\", expr_CADsCAD1mMid,\n    \"CADsCAD6mMid\", expr_CADsCAD6mMid,\n    \"CADsCAD1dMid\", expr_CADsCAD1dMid,\n    \"USDsCADUSDMid\", expr_USDsCADUSDMid,\n    BLANK()\n)",
      "solution_explanation": "Rewrote CASE as SWITCH with per-market IF sums. Mapped OR/AND to ||/&&. Used row-level arithmetic on 'Delta Down T CAD' + 'Fix Value T', so implemented as a calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T CAD 30Y",
      "dax_expression": "VAR baseCAD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T CAD] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR expr_sCADMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr Swap\", baseCAD, 0)\nVAR expr_CADsCAD1mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseCAD, 0)\nVAR expr_CADsCAD6mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseCAD, 0)\nVAR expr_CADsCAD1dMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr Swap\", 15/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr Swap\", baseCAD, 0)\nVAR expr_USDsCADUSDMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr Swap\", 15/20 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr Swap\", baseCAD, 0)\nRETURN\nSWITCH(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME],\n    \"sCADMid\", expr_sCADMid,\n    \"CADsCAD1mMid\", expr_CADsCAD1mMid,\n    \"CADsCAD6mMid\", expr_CADsCAD6mMid,\n    \"CADsCAD1dMid\", expr_CADsCAD1dMid,\n    \"USDsCADUSDMid\", expr_USDsCADUSDMid,\n    BLANK()\n)",
      "solution_explanation": "Translated CASE to SWITCH with IF conditions and weighted contributions per TERM_LABEL. Uses only row-level fields, so implemented as a calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T CAD 3M",
      "dax_expression": "VAR baseCAD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T CAD] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR last2Num = IFERROR(VALUE(RIGHT('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL], 2)), BLANK())\nVAR expr_sCADMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3M Cash\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month Swap\", 2/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month Swap\", 1/3 * baseCAD, 0)\nVAR expr_sCBOMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"O/N\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"1 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"1 Week\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Week\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Week\",\n        baseCAD,\n        0\n    )\nVAR expr_CADsCAD1mMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"O/N\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"1 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Month\",\n        baseCAD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month Swap\", 2/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month Swap\", 1/3 * baseCAD, 0)\nVAR expr_CADsCAD6mMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"O/N\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"1 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Month\",\n        baseCAD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month Swap\", 2/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month Swap\", 1/3 * baseCAD, 0)\nVAR expr_CADsCAD1dMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"O/N\" ||\n        (\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] <= 91 &&\n            (CONTAINSSTRING('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL], \"D\") || last2Num >= 17)\n        ),\n        baseCAD,\n        0\n    )\nVAR expr_USDsCADUSDMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"O/N\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"T/N\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"1 Week\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Week\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Week\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"1 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Month\",\n        baseCAD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Month Swap\", 2/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Month Swap\", 1/3 * baseCAD, 0)\nRETURN\nSWITCH(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME],\n    \"sCADMid\", expr_sCADMid,\n    \"sCBOMid\", expr_sCBOMid,\n    \"CADsCAD1mMid\", expr_CADsCAD1mMid,\n    \"CADsCAD6mMid\", expr_CADsCAD6mMid,\n    \"CADsCAD1dMid\", expr_CADsCAD1dMid,\n    \"USDsCADUSDMid\", expr_USDsCADUSDMid,\n    BLANK()\n)",
      "solution_explanation": "Converted CASE branches to SWITCH with IF conditions. Used CONTAINSSTRING and IFERROR(VALUE(RIGHT(...))) to replicate contains() and int(right()) logic. Pure row-level logic, so a calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T CAD 5Y",
      "dax_expression": "VAR baseCAD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T CAD] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR expr_sCADMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 1/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 2/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"5 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"5 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Yr Swap\", 4/5 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"7 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"7 Yr Swap\", 3/5 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"8 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"8 Yr Swap\", 2/5 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Yr Swap\", 1/5 * baseCAD, 0)\nVAR expr_CADsCAD1mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 1/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 2/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"5 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"5 Yr Swap\", baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"7 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"7 Yr Swap\", 3/5 * baseCAD, 0)\nVAR expr_CADsCAD6mMid = expr_CADsCAD1mMid\nVAR expr_CADsCAD1dMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 1/3 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 2/3 * baseCAD, 0)\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"5 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"5 Yr Swap\" || (\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Subtype] = \"Major Curve\" &&\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] > 731 &&\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] <= 1096\n        ),\n        baseCAD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"6 Yr Swap\", 4/5 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"7 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"7 Yr Swap\", 3/5 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"8 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"8 Yr Swap\", 2/5 * baseCAD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"9 Yr Swap\", 1/5 * baseCAD, 0)\nVAR expr_USDsCADUSDMid = expr_CADsCAD1mMid\nRETURN\nSWITCH(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME],\n    \"sCADMid\", expr_sCADMid,\n    \"CADsCAD1mMid\", expr_CADsCAD1mMid,\n    \"CADsCAD6mMid\", expr_CADsCAD6mMid,\n    \"CADsCAD1dMid\", expr_CADsCAD1dMid,\n    \"USDsCADUSDMid\", expr_USDsCADUSDMid,\n    BLANK()\n)",
      "solution_explanation": "Mapped CASE to SWITCH and replicated weighted IF logic per TERM_LABEL, including risk-window condition. All operations are row-level, so created as a calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T USD 30Y",
      "dax_expression": "VAR baseUSD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T USD] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR expr_sUSDMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr Swap\", 15/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr Swap\", baseUSD, 0)\nVAR expr_USDsUSD1mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseUSD, 0)\nVAR expr_USDsUSD6mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseUSD, 0)\nVAR expr_USDsUSD1dMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr Swap\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr Swap\",\n        baseUSD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr Swap\", 15/20 * baseUSD, 0)\nVAR expr_USDsUSDs1dMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"11 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"11 Yr Swap\", 1/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"12 Yr Swap\", 2/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Yr Swap\", 5/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"20 Yr Swap\", 10/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"25 Yr Swap\", 15/20 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"30 Yr Swap\", baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"40 Yr Swap\", baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"50 Yr Swap\", baseUSD, 0)\nRETURN\nSWITCH(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME],\n    \"sUSDMid\", expr_sUSDMid,\n    \"USDsUSD1mMid\", expr_USDsUSD1mMid,\n    \"USDsUSD6mMid\", expr_USDsUSD6mMid,\n    \"USDsUSD1dMid\", expr_USDsUSD1dMid,\n    \"USDsUSDs1dMid\", expr_USDsUSDs1dMid,\n    BLANK()\n)",
      "solution_explanation": "CASE converted to SWITCH with IF weights across TERM_LABELs. Uses row-level arithmetic on 'Delta Down T USD' + 'Fix Value T', so defined as a calculated column."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T USD 2Y",
      "dax_expression": "VAR baseUSD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T USD] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR last2Num = IFERROR(VALUE(RIGHT('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL], 2)), BLANK())\nVAR expr_sUSDMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month Swap\", 1/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month Swap\", 2/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month Swap\", 3/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 1/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 2/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\", baseUSD, 0)\nVAR expr_sUSOMid =\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month Swap\" ||\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2Y\",\n        baseUSD,\n        0\n    )\nVAR expr_USDsUSD1mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\", baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 2/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 1/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\", 1/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\", 2/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month\", 3/4 * baseUSD, 0)\nVAR expr_USDsUSD6mMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\", baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 2/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 1/3 * baseUSD, 0)\nVAR expr_USDsUSD12mMid = expr_USDsUSD6mMid\nVAR expr_USDsUSD1dMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"15 Month\", 1/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"18 Month Swap\", 2/4 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"21 Month Swap\", 3/4 * baseUSD, 0)\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\" || (\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] > 365 &&\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] <= 731 &&\n            last2Num >= 17\n        ),\n        baseUSD,\n        0\n    )\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 2/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 1/3 * baseUSD, 0)\nVAR expr_USDsUSDs1dMid =\n    IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"3 Yr Swap\", 2/3 * baseUSD, 0)\n    + IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"4 Yr Swap\", 1/3 * baseUSD, 0)\n    + IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr\" || 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL] = \"2 Yr Swap\" || (\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] > 365 &&\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days] <= 731\n        ),\n        baseUSD,\n        0\n    )\nRETURN\nSWITCH(\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME],\n    \"sUSDMid\", expr_sUSDMid,\n    \"sUSOMid\", expr_sUSOMid,\n    \"USDsUSD1mMid\", expr_USDsUSD1mMid,\n    \"USDsUSD6mMid\", expr_USDsUSD6mMid,\n    \"USDsUSD12mMid\", expr_USDsUSD12mMid,\n    \"USDsUSD1dMid\", expr_USDsUSD1dMid,\n    \"USDsUSDs1dMid\", expr_USDsUSDs1dMid,\n    BLANK()\n)",
      "solution_explanation": "Converted CASE to SWITCH with branch-specific IF sums. Used IFERROR(VALUE(RIGHT(...))) to mirror int(right()) and logical operators ||/&&. Row-level logic only, so created as a calculated column."
    }
  ]
}