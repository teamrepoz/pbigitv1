{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "MAX_DATE -1day",
      "dax_expression": "VAR wd = WEEKDAY('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Max Date Exclude])\nRETURN\nSWITCH(\n    wd,\n    1, 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Max Date Exclude] - 2,\n    2, 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Max Date Exclude] - 3,\n    'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Max Date Exclude] - 1\n)",
      "solution_explanation": "Replaced Tableau CASE on DATEPART('weekday',[Max Date Exclude]) with DAX WEEKDAY and SWITCH. All column references were converted to the 'table'[column] format: [Max Date Exclude] -> 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Max Date Exclude]. This is a row-level date adjustment (no aggregation or parameters), so it is implemented as a calculated column."
    }
  ]
}