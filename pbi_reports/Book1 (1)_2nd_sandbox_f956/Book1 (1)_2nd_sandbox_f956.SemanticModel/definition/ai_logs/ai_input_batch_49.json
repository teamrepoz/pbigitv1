{
  "calculations": [
    {
      "name": "Swap Spread Filter Dyn",
      "table_name": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "tableau_expression": "case [Parameters].[DV01 or Swap Spread]\r\nwhen \"All DV01\" then 1\r\nwhen \"Swap Spread\" then if [Swap Spread Filter]=1 then 1 else 0 END\r\nwhen \"Non Swap Spread\" then if [Swap Spread Filter]=0 then 1 else 0 END\r\nend",
      "datatype": "integer",
      "calculation_context": {
        "Expression": "case [Parameters].[DV01 or Swap Spread]\r\nwhen \"All DV01\" then 1\r\nwhen \"Swap Spread\" then if [Swap Spread Filter]=1 then 1 else 0 END\r\nwhen \"Non Swap Spread\" then if [Swap Spread Filter]=0 then 1 else 0 END\r\nend",
        "calculated_fields": {
          "Swap Spread Filter": "//if [Instrument Type]=\"Bond Option\" \r\n //[Instrument Type]=\"Caps/Floors\" \r\n//or [Instrument Type]=\"Forex\" \r\n//or [Instrument Type]=\"IR Futures\" \r\n//or [Instrument Type]=\"IR Futures Option\" \r\n//or [Instrument Type]=\"Swaps\" \r\n//or [Instrument Type]=\"Swaption\" \r\n//or [Instrument Type]=\"Swaptions\" \r\n\r\n//then 1 else 0 end\r\n\r\n// Created by Antoine Des Aulniers Favreau\r\n// Updated on 10/13/2017 by Antoine Des Aulniers Favreau\r\n// Filter to isolate the instruments creating swap spread risk.\r\n\r\n\r\n\r\nif [INSTRUMENT_TYPE]=\"CDS\"\r\nor [INSTRUMENT_TYPE]=\"FX Forward\"\r\nor [INSTRUMENT_TYPE]=\"FX Forward Non-Deliverable\"\r\nor [INSTRUMENT_TYPE]=\"FX Futures\"\r\nor [INSTRUMENT_TYPE]=\"IR Futures\"\r\nor [INSTRUMENT_TYPE]=\"FX Spot\"\r\nor [INSTRUMENT_TYPE]=\"Swaps\"\r\nor [INSTRUMENT_TYPE]=\"Forex\"\r\nor [INSTRUMENT_TYPE]=\"Swaptions\"\r\nor [INSTRUMENT_TYPE]=\"Caps/Floors\"\r\nor [INSTRUMENT_TYPE]=\"TERM DEPOSIT WITH BNS UNIT ROL\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT BY BANK\"\r\nor [INSTRUMENT_TYPE]=\"CALL LOAN FLOATING\"\r\nor [INSTRUMENT_TYPE]=\"EVERGREEN & MARGIN LOCK 3M\"\r\nor [INSTRUMENT_TYPE]=\"NON-ACCRUAL FLOATING\"\r\nor [INSTRUMENT_TYPE]=\"TIME DEPOSIT BY BANK\"\r\nor [INSTRUMENT_TYPE]=\"FLOATING CALL NOTICE DEPOSIT\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT WITH BNS SUBSIDIARY RO\"\r\nor [INSTRUMENT_TYPE]=\"TERM DEPOSIT BY BNS UNIT (ROLL\"\r\nor [INSTRUMENT_TYPE]=\"Loan/Deposit\"\r\nor [INSTRUMENT_TYPE]=\"ARBITRAGE LOAN\"\r\nor [INSTRUMENT_TYPE]=\"EVERGREEN & MARGIN LOCK 1Y\"\r\nor [INSTRUMENT_TYPE]=\"FLOATING NOTICE DEPOSITS 6M\"\r\nor [INSTRUMENT_TYPE]=\"TERM DEPOSIT WITH BNS UNIT\"\r\nor [INSTRUMENT_TYPE]=\"TERM DEPOSIT BY BNS UNIT\"\r\nor [INSTRUMENT_TYPE]=\"CALL DEPOSIT FLOAT\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT WITH BNS SUBSIDIARY\"\r\nor [INSTRUMENT_TYPE]=\"INFRASTRUCTURE AMORTIZING DEP\"\r\nor [INSTRUMENT_TYPE]=\"EVERGREEN & MARGIN LOCK 6M\"\r\nor [INSTRUMENT_TYPE]=\"O/N FED FUNDS PURCHASED\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT BY BNS SUBSIDIARY\"\r\nor [INSTRUMENT_TYPE]=\"FIXED CALL NOTICE DEPOSIT\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT WITH BANK ROLLOVER\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT BY BNS SUBSIDIARY ROLL\"\r\nor [INSTRUMENT_TYPE]=\"COMMERCIAL LOAN\"\r\nor [INSTRUMENT_TYPE]=\"ARBITRAGE DEPOSIT\"\r\nor [INSTRUMENT_TYPE]=\"TIME DEPOSIT BY BANK ROLLOVER\"\r\nor [INSTRUMENT_TYPE]=\"TERM FED FUNDS PURCHASED\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT WITH BANK\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT BY BANK (ROLLOVER)\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT BY CUSTOMER (ROLL\"\r\nor [INSTRUMENT_TYPE]=\"DEPOSIT BY CUSTOMER\"\r\nor [INSTRUMENT_TYPE]=\"CALL LOAN FIXED\"\r\nor [INSTRUMENT_TYPE]=\"CALL DEPOSIT  FIXED\"\r\nor [INSTRUMENT_TYPE]=\"IR Futures Option\"\r\nor [INSTRUMENT_TYPE]=\"FX Swap\"\r\n\r\nthen 1 else 0 end",
          "DV01 or Swap Spread": "\"All DV01\""
        },
        "parameters": [
          "DV01 or Swap Spread"
        ],
        "col_to_datatype_mapping": {
          "INSTRUMENT_TYPE": "string"
        },
        "calc_fields_to_datatype_mapping": {
          "Swap Spread Filter": "integer",
          "DV01 or Swap Spread": "string"
        }
      }
    }
  ]
}