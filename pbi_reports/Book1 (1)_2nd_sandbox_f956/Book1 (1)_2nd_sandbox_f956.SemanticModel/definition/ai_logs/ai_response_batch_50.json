{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "NVega Up + Vega Up",
      "dax_expression": "'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[NVEGA_UP] + 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[VEGA_UP]",
      "solution_explanation": "Row-level addition of NVEGA_UP and VEGA_UP translated to DAX using table column references."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Vega & NVega Up CAD",
      "dax_expression": "'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[NVega Up + Vega Up] * 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TO_CAD]",
      "solution_explanation": "Row-level multiplication of the combined vega value by TO_CAD translated to DAX using table column references."
    },
    {
      "type": "measure",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Max Date Exclude",
      "dax_expression": "VAR wd = WEEKDAY(TODAY())\nRETURN\nSWITCH(\n    TRUE(),\n    wd = 1, TODAY() - 2,\n    wd = 2, TODAY() - 3,\n    TODAY() - 1\n)",
      "solution_explanation": "Translated the Tableau weekday-based case on TODAY() to a DAX SWITCH returning TODAY() offset by days. Implemented as a measure because it derives a single date value from TODAY() (not row-level)."
    },
    {
      "type": "measure",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "MAX_DATE -1day",
      "dax_expression": "VAR md = [Max Date Exclude]\nVAR wd = WEEKDAY(md)\nRETURN\nSWITCH(\n    TRUE(),\n    wd = 1, md - 2,\n    wd = 2, md - 3,\n    md - 1\n)",
      "solution_explanation": "Translated the Tableau weekday-based adjustment of Max Date Exclude to DAX. Implemented as a measure since it derives from the Max Date Exclude measure (scalar date logic)."
    },
    {
      "type": "measure",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Date Sign",
      "dax_expression": "VAR UseCustom = SELECTEDVALUE('Use Custom Date'[Display As])\nVAR EndDateParam = SELECTEDVALUE('End Date'[Display As])\nVAR StartDateParam = SELECTEDVALUE('Start Date'[Display As])\nRETURN\nIF(\n    UseCustom,\n    IF(\n        [Max Date Exclude] = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[EFFECTIVE_DATE],\n        1,\n        IF([MAX_DATE -1day] = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[EFFECTIVE_DATE], -1, 0)\n    ),\n    IF(\n        'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[EFFECTIVE_DATE] = EndDateParam, 1,\n        IF('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[EFFECTIVE_DATE] = StartDateParam, -1, 0)\n    )\n)",
      "solution_explanation": "Converted the nested IF logic from Tableau to DAX and replaced parameter references with SELECTEDVALUE(...) per rules. Uses the Max Date Exclude and MAX_DATE -1day measures and compares them to the EFFECTIVE_DATE column.",
      "type_changed_reason": "The calculation depends on Tableau parameters ([Parameters] references). All parameter-based calculations must be implemented as measures."
    },
    {
      "type": "measure",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Vega & NVega Up CAD Diff",
      "dax_expression": "'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Vega & NVega Up CAD] * [Date Sign]",
      "solution_explanation": "Multiplies the row-level Vega & NVega Up CAD calculated column by the Date Sign measure. Implemented as a measure because it depends on the Date Sign measure (which references parameters).",
      "type_changed_reason": "Depends (directly or indirectly) on a parameter-based calculation (Date Sign). Per rules, parameter-involving logic must be a measure."
    }
  ]
}