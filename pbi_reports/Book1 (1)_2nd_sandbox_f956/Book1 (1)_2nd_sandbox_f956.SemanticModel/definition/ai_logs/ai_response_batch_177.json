{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Title",
      "dax_expression": "VAR mktName = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME]\nVAR mktTitle = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_TITLE]\nVAR leftChar = IF(LEN(mktName) >= 1, LEFT(mktName, 1), \"\")\nVAR core = REPLACE(REPLACE(mktName, \"Mid\", \"\"), \"s\", \"\")\nRETURN\nIF(\n    ISBLANK(mktTitle),\n    IF(\n        CONTAINSSTRING(mktName, \"Mid\"),\n        IF(\n            leftChar = \"s\" && LEN(mktName) = 7,\n            SWITCH(\n                core,\n                \"USO\", \"Major USD\",\n                \"CBO\", \"Major CAD\",\n                \"EBO\", \"Major EUR\",\n                \"GBO\", \"Major GBP\",\n                \"Major \" & core\n            ),\n            IF(\n                CONTAINSSTRING(mktName, \"USDs\") && CONTAINSSTRING(mktName, \"USDMid\"),\n                \"CCIRS \" & REPLACE(REPLACE(mktName, \"USDs\", \"\"), \"USDMid\", \"\") & \" Basis\",\n                IF(\n                    mktName = \"USDsUSDCUPOMMid\", \"3m USD CUPOM Basis\",\n                    IF(\n                        mktName = \"EURsEURLibor-6mMid\", \"6m EUR Libor Basis\",\n                        IF(\n                            leftChar = \"f\",\n                            IF(\n                                CONTAINSSTRING(mktName, \"swpnN\"), MID(mktName, 2, 3) & \" Normal Swaption Vol\",\n                                IF(\n                                    CONTAINSSTRING(mktName, \"swpn\"), MID(mktName, 2, 3) & \" Swaption Vol\",\n                                    IF(\n                                        CONTAINSSTRING(mktName, \"SABRN\"), MID(mktName, 2, 3) & \" Normal SABR Vol\",\n                                        IF(\n                                            CONTAINSSTRING(mktName, \"SABR\"), MID(mktName, 2, 3) & \" SABR Vol\",\n                                            IF(\n                                                CONTAINSSTRING(mktName, \"cap\") && CONTAINSSTRING(mktName, \"1mNMid\"), MID(mktName, 2, 3) & \" Normal 1M CAP Vol\",\n                                                IF(\n                                                    CONTAINSSTRING(mktName, \"cap\") && CONTAINSSTRING(mktName, \"NMid\"), MID(mktName, 2, 3) & \" Normal CAP Vol\",\n                                                    IF(\n                                                        CONTAINSSTRING(mktName, \"cap\"), MID(mktName, 2, 3) & \" CAP Vol\",\n                                                        \"ERR\"\n                                                    )\n                                                )\n                                            )\n                                        )\n                                    )\n                                )\n                            ),\n                            IF(\n                                CONTAINSSTRING(mktName, \"1m\") && CONTAINSSTRING(mktName, \"Mid\"), \"1m \" & LEFT(mktName, 3) & \" Basis\",\n                                IF(\n                                    CONTAINSSTRING(mktName, \"3\") && CONTAINSSTRING(mktName, \"Mid\"), \"3m \" & LEFT(mktName, 3) & \" Basis\",\n                                    IF(\n                                        CONTAINSSTRING(mktName, \"6\") && CONTAINSSTRING(mktName, \"Mid\"), \"6m \" & LEFT(mktName, 3) & \" Basis\",\n                                        IF(\n                                            CONTAINSSTRING(mktName, \"12\") && CONTAINSSTRING(mktName, \"Mid\"), \"12m \" & LEFT(mktName, 3) & \" Basis\",\n                                            mktName\n                                        )\n                                    )\n                                )\n                            )\n                        )\n                    )\n                )\n            )\n        ),\n        IF(CONTAINSSTRING(mktTitle, \"Eur\"), REPLACE(mktTitle, \"Eur\", \"EUR\"), mktTitle)\n    ),\n    mktTitle\n)",
      "solution_explanation": "Converted the row-level Tableau IF/CASE logic into a DAX calculated column using VARs for intermediate values (mktName, mktTitle, leftChar, core). Used ISBLANK for ISNULL, CONTAINSSTRING for CONTAINS, MID/LEFT/LEN/REPLACE for string operations, SWITCH for the CASE-on-string mapping, and nested IFs to preserve original branching logic. All column references use 'TableName'[Column] format."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Subtype",
      "dax_expression": "VAR mktSub = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_SUBTYPE]\nVAR mktTitle = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Title]\nRETURN\nIF(\n    ISBLANK(mktSub),\n    IF(\n        CONTAINSSTRING(mktTitle, \"Major\"), \"Major Curve\",\n        IF(\n            CONTAINSSTRING(mktTitle, \"CCIRS\"), \"CCIRS Basis\",\n            IF(\n                CONTAINSSTRING(mktTitle, \"1m\"), \"1m Basis\",\n                IF(\n                    CONTAINSSTRING(mktTitle, \"3m\"), \"3m Basis\",\n                    IF(\n                        CONTAINSSTRING(mktTitle, \"6m\"), \"6m Basis\",\n                        IF(\n                            CONTAINSSTRING(mktTitle, \"12m\"), \"12m Basis\",\n                            IF(\n                                CONTAINSSTRING(mktTitle, \"Vol\"), MID(mktTitle, 5, LEN(mktTitle) - 4),\n                                'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_TYPE]\n                            )\n                        )\n                    )\n                )\n            )\n        )\n    ),\n    mktSub\n)",
      "solution_explanation": "Translated the Tableau row-level conditional into a DAX calculated column. Used ISBLANK for ISNULL, CONTAINSSTRING for CONTAINS, and MID with LEN to emulate mid(...,5) (substring from the 5th character to end). Referenced the previously created 'Market Title' calculated column and preserved the original branching. All references use 'TableName'[Column]."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Subtype Vega",
      "dax_expression": "VAR mktSub = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Subtype]\nVAR mktName = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME]\nRETURN\nSWITCH(\n    TRUE(),\n    mktSub = \"CAP Vol\" && mktName = \"fUSDcap1mNMid\", \"1m Normal Vol\",\n    mktSub = \"CAP Vol\", \"3m Normal Vol\",\n    mktSub = \"SABR Vol\", \"Black Vol\",\n    mktSub = \"Swaption Vol\", \"Black Vol\",\n    mktSub = \"Normal SABR Vol\" && CONTAINSSTRING(mktName, \"accr\"), \"3m Normal Accr Vol\",\n    mktSub = \"Normal SABR Vol\", \"3m Normal Vol\",\n    mktSub = \"Normal Swaption Vol\", \"3m Normal Vol\",\n    mktSub\n)",
      "solution_explanation": "Converted the Tableau CASE expression to a DAX calculated column. Used VARs for clarity, SWITCH(TRUE(), ...) to emulate CASE/WHEN branching, and CONTAINSSTRING for contains(). Preserved the original conditional ordering (special-case CAP Vol with exact market name, then fallback) and returned the Market Subtype by default. All column references formatted as 'TableName'[Column]."
    }
  ]
}