{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Title",
      "dax_expression": "VAR mkName = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME]\nVAR mkTitle = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_TITLE]\nVAR cleaned = SUBSTITUTE(SUBSTITUTE(mkName, \"Mid\", \"\"), \"s\", \"\")\nRETURN\nIF(\n    ISBLANK(mkTitle),\n    IF(\n        CONTAINSSTRING(mkName, \"Mid\"),\n        IF(\n            LEFT(mkName, 1) = \"s\" && LEN(mkName) = 7,\n            SWITCH(\n                cleaned,\n                \"USO\", \"Major USD\",\n                \"CBO\", \"Major CAD\",\n                \"EBO\", \"Major EUR\",\n                \"GBO\", \"Major GBP\",\n                \"Major \" & cleaned\n            ),\n            IF(\n                CONTAINSSTRING(mkName, \"USDs\") && CONTAINSSTRING(mkName, \"USDMid\"),\n                \"CCIRS \" & SUBSTITUTE(SUBSTITUTE(mkName, \"USDs\", \"\"), \"USDMid\", \"\") & \" Basis\",\n                IF(\n                    mkName = \"USDsUSDCUPOMMid\", \"3m USD CUPOM Basis\",\n                    IF(\n                        mkName = \"EURsEURLibor-6mMid\", \"6m EUR Libor Basis\",\n                        IF(\n                            LEFT(mkName, 1) = \"f\",\n                            IF(\n                                CONTAINSSTRING(mkName, \"swpnN\"), MID(mkName, 2, 3) & \" Normal Swaption Vol\",\n                                IF(\n                                    CONTAINSSTRING(mkName, \"swpn\"), MID(mkName, 2, 3) & \" Swaption Vol\",\n                                    IF(\n                                        CONTAINSSTRING(mkName, \"SABRN\"), MID(mkName, 2, 3) & \" Normal SABR Vol\",\n                                        IF(\n                                            CONTAINSSTRING(mkName, \"SABR\"), MID(mkName, 2, 3) & \" SABR Vol\",\n                                            IF(\n                                                CONTAINSSTRING(mkName, \"cap\") && CONTAINSSTRING(mkName, \"1mNMid\"), MID(mkName, 2, 3) & \" Normal 1M CAP Vol\",\n                                                IF(\n                                                    CONTAINSSTRING(mkName, \"cap\") && CONTAINSSTRING(mkName, \"NMid\"), MID(mkName, 2, 3) & \" Normal CAP Vol\",\n                                                    IF(\n                                                        CONTAINSSTRING(mkName, \"cap\"), MID(mkName, 2, 3) & \" CAP Vol\",\n                                                        \"ERR\"\n                                                    )\n                                                )\n                                            )\n                                        )\n                                    )\n                                )\n                            ),\n                            IF(\n                                CONTAINSSTRING(mkName, \"1m\") && CONTAINSSTRING(mkName, \"Mid\"), \"1m \" & LEFT(mkName, 3) & \" Basis\",\n                                IF(\n                                    CONTAINSSTRING(mkName, \"3\") && CONTAINSSTRING(mkName, \"Mid\"), \"3m \" & LEFT(mkName, 3) & \" Basis\",\n                                    IF(\n                                        CONTAINSSTRING(mkName, \"6\") && CONTAINSSTRING(mkName, \"Mid\"), \"6m \" & LEFT(mkName, 3) & \" Basis\",\n                                        IF(\n                                            CONTAINSSTRING(mkName, \"12\") && CONTAINSSTRING(mkName, \"Mid\"), \"12m \" & LEFT(mkName, 3) & \" Basis\",\n                                            mkName\n                                        )\n                                    )\n                                )\n                            )\n                        )\n                    )\n                )\n            )\n        ),\n        IF(\n            CONTAINSSTRING(mkName, \"skew\"), MID(mkName, 2, 3) & \" Swaption Skew Vol\",\n            IF(CONTAINSSTRING(mkName, \"IR \"), SUBSTITUTE(mkName, \"IR \", \"Major \"), mkName)\n        )\n    ),\n    IF(CONTAINSSTRING(mkTitle, \"Eur\"), SUBSTITUTE(mkTitle, \"Eur\", \"EUR\"), mkTitle)\n)",
      "solution_explanation": "Converted the Tableau nested IF/CASE logic to a DAX calculated column using VARs for readability. CONTAINS -> CONTAINSSTRING, ISNULL -> ISBLANK, REPLACE/SUBSTITUTE handled with SUBSTITUTE, MID/LEFT/LEN preserved. String concatenation uses &."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Subtype",
      "dax_expression": "VAR mktSubtype = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_SUBTYPE]\nVAR mktTitle = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Title]\nRETURN\nIF(\n    ISBLANK(mktSubtype),\n    IF(\n        CONTAINSSTRING(mktTitle, \"Major\"), \"Major Curve\",\n        IF(\n            CONTAINSSTRING(mktTitle, \"CCIRS\"), \"CCIRS Basis\",\n            IF(\n                CONTAINSSTRING(mktTitle, \"1m\"), \"1m Basis\",\n                IF(\n                    CONTAINSSTRING(mktTitle, \"3m\"), \"3m Basis\",\n                    IF(\n                        CONTAINSSTRING(mktTitle, \"6m\"), \"6m Basis\",\n                        IF(\n                            CONTAINSSTRING(mktTitle, \"12m\"), \"12m Basis\",\n                            IF(\n                                CONTAINSSTRING(mktTitle, \"Vol\"), MID(mktTitle, 5, LEN(mktTitle)),\n                                'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_TYPE]\n                            )\n                        )\n                    )\n                )\n            )\n        )\n    ),\n    mktSubtype\n)",
      "solution_explanation": "Translated Tableau ISNULL and CONTAINS checks into DAX ISBLANK and CONTAINSSTRING. Preserved row-level logic and returned existing MARKET_TYPE when no subtype is inferred. Implemented as a calculated column because it depends on row-level fields."
    },
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Market Type",
      "dax_expression": "RETURN\nIF(\n    CONTAINSSTRING('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Subtype], \"Major Curve\"), \"Major IR\",\n    IF(\n        CONTAINSSTRING('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Subtype], \"Minor\"), \"Minor IR\",\n        IF(\n            CONTAINSSTRING('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Market Subtype], \"Vol\"), \"Vol Surface\",\n            'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_TYPE]\n        )\n    )\n)",
      "solution_explanation": "Converted Tableau IF/CONTAINS logic into a DAX calculated column using CONTAINSSTRING for substring checks and retained the fallback to MARKET_TYPE. This is row-level logic, so created as a calculated column."
    }
  ]
}