{
  "fixes": [
    {
      "type": "calculated_column",
      "table": "Risk_GFIRates_Reports_Excel_Rolling (local copy)",
      "name": "Delta Down T CAD 3M",
      "dax_expression": "VAR Market = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[MARKET_NAME]\nVAR Term = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[TERM_LABEL]\nVAR DeltaCAD = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Delta Down T CAD]\nVAR FixT = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Fix Value T]\nVAR RiskDays = 'Risk_GFIRates_Reports_Excel_Rolling (local copy)'[Risk Date # of Days]\nRETURN\nSWITCH(\n    Market,\n    \"sCADMid\",\n        IF(Term = \"3M Cash\", DeltaCAD + FixT, 0)\n        + IF(Term = \"6 Month\" || Term = \"6 Month Swap\", 2/3 * (DeltaCAD + FixT), 0)\n        + IF(Term = \"9 Month\" || Term = \"9 Month Swap\", 1/3 * (DeltaCAD + FixT), 0),\n    \"sCBOMid\",\n        IF(\n            Term = \"O/N\" || Term = \"1 Month\" || Term = \"2 Month\" || Term = \"3 Month\" ||\n            Term = \"1 Week\" || Term = \"2 Week\" || Term = \"3 Week\",\n            DeltaCAD + FixT,\n            0\n        ),\n    \"CADsCAD1mMid\",\n        IF(\n            Term = \"O/N\" || Term = \"1 Month\" || Term = \"2 Month\" || Term = \"3 Month\",\n            DeltaCAD + FixT,\n            0\n        )\n        + IF(Term = \"6 Month\" || Term = \"6 Month Swap\", 2/3 * (DeltaCAD + FixT), 0)\n        + IF(Term = \"9 Month\" || Term = \"9 Month Swap\", 1/3 * (DeltaCAD + FixT), 0),\n    \"CADsCAD6mMid\",\n        IF(\n            Term = \"O/N\" || Term = \"1 Month\" || Term = \"2 Month\" || Term = \"3 Month\",\n            DeltaCAD + FixT,\n            0\n        )\n        + IF(Term = \"6 Month\" || Term = \"6 Month Swap\", 2/3 * (DeltaCAD + FixT), 0)\n        + IF(Term = \"9 Month\" || Term = \"9 Month Swap\", 1/3 * (DeltaCAD + FixT), 0),\n    \"CADsCAD1dMid\",\n        IF(\n            Term = \"O/N\" ||\n            (RiskDays <= 91 && (CONTAINSSTRING(Term, \"D\") || VALUE(RIGHT(Term, 2)) >= 17)),\n            DeltaCAD + FixT,\n            0\n        ),\n    \"USDsCADUSDMid\",\n        IF(\n            Term = \"O/N\" || Term = \"T/N\" || Term = \"1 Week\" || Term = \"2 Week\" || Term = \"3 Week\" ||\n            Term = \"1 Month\" || Term = \"2 Month\" || Term = \"3 Month\",\n            DeltaCAD + FixT,\n            0\n        )\n        + IF(Term = \"6 Month\" || Term = \"6 Month Swap\", 2/3 * (DeltaCAD + FixT), 0)\n        + IF(Term = \"9 Month\" || Term = \"9 Month Swap\", 1/3 * (DeltaCAD + FixT), 0),\n    0\n)",
      "solution_explanation": "Converted the Tableau CASE ... WHEN into a DAX SWITCH on the MARKET_NAME field. Row-level checks on TERM_LABEL were translated to IF expressions; CONTAINS(...) was mapped to CONTAINSSTRING(...); int(right(...)) was mapped to VALUE(RIGHT(...)); calculated fields (Delta Down T CAD, Fix Value T, Risk Date # of Days) were referenced as columns in the same table ('Risk_GFIRates_Reports_Excel_Rolling (local copy)'[...]). The logic preserves the original additive IF blocks for the various TERM_LABEL conditions. Chosen as a calculated column because the expression operates at row-level without aggregates or parameters."
    }
  ]
}